openapi: 3.0.2
info:
  title: multi-tenant-service API
  version: "1.0"
paths:
  /mt/monitor/v1/agg/alerts/list:
    post:
      tags:
        - Data Resource API
      summary: Get Alerts Counts By Source
      description: Get alerts counts by source across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Alert'
            examples:
              Alerts Count By Source:
                value:
                  properties:
                    - property: total_count
                    - property: mu_count
                    - property: rn_count
                    - property: sc_count
                  filter:
                    operator: AND
                    rules:
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Alerts Count By Source:
                  value:
                    - total_count: 10
                      rn_count: 10
                      mu_count: 10
                      sc_count: 10
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/applications/list:
    post:
      tags:
        - Data Resource API
      summary: Get Application List
      description: Get Application List across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Application'
            examples:
              Applications List:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: unique_total_apps
                    - property: risk_of_app_count
                    - property: blocked_app_count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Applications List:
                  value:
                    - sub_tenant_id: "1234"
                      unique_total_apps: "2"
                      risk_of_app_count: "3"
                      blocked_app_count: 10

        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/applications/source:
    post:
      tags:
        - Data Resource API
      summary: Get App Counts by source
      description: Get App Counts by source across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_AppSrc'
            examples:
              Risky Application Count by Source per Tenant:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: total_app_count
                    - property: total_app_remote_network
                    - property: total_app_mobile_users
                    - property: total_app_proxy_nodes
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Risky Application Count by Source:
                value:
                  properties:
                    - property: total_app_count
                    - property: total_app_remote_network
                    - property: total_app_mobile_users
                    - property: total_app_proxy_nodes
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Risky Application Count by Source per Tenant:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      total_app_count: 10
                      total_app_remote_network: 10
                      total_app_mobile_users: 10
                      total_app_proxy_nodes: 10
                Risky Application Count by Source:
                  value:
                    - total_app_count: 10
                      total_app_remote_network: 10
                      total_app_mobile_users: 10
                      total_app_proxy_nodes: 10
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/applications/summary:
    post:
      tags:
        - Data Resource API
      summary: Get Risky App Counts
      description: Get Risky App Counts across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_AppSummary'
            examples:
              Total Risky Apps Per Tenant:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: total_app_count
                    - property: risk_of_app_count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Total Risky Apps:
                value:
                  properties:
                    - property: total_app_count
                    - property: risk_of_app_count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Blocked Risky Apps:
                value:
                  properties:
                    - property: total_app_count
                    - property: risk_of_app_count
                    - property: blocked_app_count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Unblocked Risky Apps:
                value:
                  properties:
                    - property: total_app_count
                    - property: risk_of_app_count
                    - property: unblocked_app_count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Top Tenants using Risky Applications:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: risk_of_app_count
                      alias: value
                      sort:
                        order: desc
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                  count: 4
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Total Risky Apps Per Tenant:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      total_app_count: 10
                      risk_of_app_count: 10
                Total Risky Apps:
                  value:
                    - total_app_count: 10
                      risk_of_app_count: 10
                Blocked Risky Apps:
                  value:
                    - total_app_count: 10
                      risk_of_app_count: 10
                      blocked_apps_count: 10
                Unblocked Risky Apps:
                  value:
                    - total_app_count: 10
                      risk_of_app_count: 10
                      unblocked_apps_count: 10
                Top Tenants using Risky Applications:
                  value:
                    - sub_tenant_id: <sub-tenant-id>
                      value: 6
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/custom/serviceConnectivity/status:
    get:
      tags:
        - Service connectivity status API
      summary: Get Service connectivity status
      description: Get Service connectivity status
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: nodeType
          description: The value can be CDL,MU,SC,RN or a combination of them
          example: CDL,MU,SC,RN
          in: query
          schema:
            type: string
        - name: status
          description: Status of the site, it can be Up, Down, Warning or combination of three
          example: Up, Down
          in: query
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceConnectivityCount'
              examples:
                Service connectivity status:
                  value:
                    sub_tenant_id: <sub_tenant_id>
                    status: <status>
                    mu_count: 5000
                    rn_count: 2
                    cdl_count: 3
                    sc_count: 2
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/serviceConnectivity/cdlStatus:
    post:
      tags:
        - Data Resource API
      summary: Get CDL Connectivity Status
      description: Get CDL Connectivity Status
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_CDLStatus'
            examples:
              Cortex Data Lake Connections:
                value:
                  properties:
                    - property: status
                    - property: location_count
                  filter:
                    rules:
                      - property: state
                        operator: in
                        values:
                          - Up
                          - Down
              Cortex Data Lake Connections per Tenant:
                value:
                  properties:
                    - property: status
                    - property: location_count
                    - property: sub_tenant_id
                  filter:
                    rules:
                      - property: state
                        operator: in
                        values:
                          - Up
                          - Down
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Cortex Data Lake Connections per Tenant:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      location_count: 100
                      status: <status>
                Cortex Data Lake Connections:
                  value:
                    - location_count: 100
                      status: <status>
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/serviceConnectivity/gatewayStatus:
    post:
      tags:
        - Data Resource API
      summary: Get Mobile Gateway Connection Status
      description: Get Mobile Gateway Connection Status
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_GatewayStatus'
            examples:
              Gateway Locations:
                value:
                  properties:
                    - property: status
                    - property: gateway_count
              Gateway Locations per Tenant:
                value:
                  properties:
                    - property: status
                    - property: gateway_count
                    - property: sub_tenant_id
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Gateway Locations:
                  value:
                    - gateway_count: 100
                      status: <status>
                Gateway Locations per Tenant:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      gateway_count: 100
                      status: <status>
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/serviceConnectivity/licenseAllocated:
    get:
      tags:
        - Data Resource API
      summary: Total GP License allocated
      description: Total GP License allocated(mobile_users - explicit_proxy)
      parameters:
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Total GP License Allocated:
                  value:
                    - remote_networks:
                        unit: mbps
                        size: 10000
                      mobile_users:
                        unit: user
                        size: 10000
                      okyo:
                        unit: user
                        size: 0
                      explicit_proxy:
                        size: 0
                        unit: user
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/serviceConnectivity/topOutliers:
    post:
      tags:
        - Data Resource API
      summary: Get top outliers(sites which consumes more bandwidth than allocated)
      description: Get top outliers(sites which consumes more bandwidth than allocated)
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Outliers'
            examples:
              Top Outliers:
                value:
                  properties:
                    - property: site_name
                    - property: bandwidth_consumed
                    - property: unit
                  filter:
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 45
                      - property: threshold
                        operator: gt
                        values:
                          - 80
                      - property: node_type
                        operator: in
                        values:
                          - 48
                  count: 5
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Top Outliers:
                  value:
                    - site_name: <site_name>
                      bandwidth_consumed: 10
                      unit: "Kbps"
                    - site_name: <site_name>
                      count: 9
                      bandwidth_consumed: 100
                      unit: "Kbps"

        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/serviceConnectivity/uniqueUsers:
    post:
      tags:
        - Data Resource API
      summary: Get Unique GP users connected in last 90 days
      description: Get Unique GP users connected in last 90 days
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_UniqueUsers'
            examples:
              Unique Users GP:
                value:
                  properties:
                    - property: user_count
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Unique Users GP:
                  value:
                    - user_count: 100
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/threats/list:
    post:
      tags:
        - Data Resource API
      summary: Get Threats List
      description: Get Threats List across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Threat'
            examples:
              Threat List:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: total_threats
                    - property: blocked_count
                    - property: unblocked_count
                    - property: malicious_count
                    - property: unknown_count
                  filter:
                    operator: AND
                    rules:
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Threat List:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      total_threats: 10
                      blocked_count: 10
                      unblocked_count: 10
                      malicious_count: 10
                      unknown_count: 10

        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/threats/source:
    post:
      tags:
        - Data Resource API
      summary: Get Threat Counts by source
      description: Get Threat counts by source across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_ThreatSrc'
            examples:
              Threat Count by Source per Tenant:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: total_threats
                    - property: total_remote_network
                    - property: total_mobile_users
                    - property: total_proxy_nodes
                  filter:
                    operator: AND
                    rules:
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Threat Count by Source:
                value:
                  properties:
                    - property: total_threats
                    - property: total_remote_network
                    - property: total_mobile_users
                    - property: total_proxy_nodes
                  filter:
                    operator: AND
                    rules:
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Threat Count by Source per Tenant:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      total_threats: 10
                      total_remote_network: 10
                      total_mobile_users: 10
                      total_proxy_nodes: 10
                Threat Count by Source:
                  value:
                    - total_threats: 10
                      total_remote_network: 10
                      total_mobile_users: 10
                      total_proxy_nodes: 10
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/threats/summary:
    post:
      tags:
        - Data Resource API
      summary: Get Threats Summary
      description: Get Summary of Threats across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_ThreatSummary'
            examples:
              Total Critical Threats:
                value:
                  properties:
                    - property: total_threats
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
              Blocked Threats:
                value:
                  properties:
                    - property: total_threats
                    - property: blocked_count
                  filter:
                    operator: AND
                    rules:
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Unblocked Threats:
                value:
                  properties:
                    - property: total_threats
                    - property: unblocked_count
                  filter:
                    operator: AND
                    rules:
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Total Critical Threats Per Tenant:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: total_threats
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
              Threat Summary:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: total_threats
                    - property: blocked_count
                    - property: unblocked_count
                    - property: malicious_count
                    - property: unknown_count
                    - property: wildfire_verdict
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
              Top Tenants with Unblocked Threats:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: total_threats
                      alias: total
                    - property: unblocked_count
                      alias: value
                      sort:
                        order: desc
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                  count: 2
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Total Critical Threats:
                  value:
                    - total_threats: 10
                Blocked Threats:
                  value:
                    - total_threats: 10
                      blocked_count: 10
                Unblocked Threats:
                  value:
                    - total_threats: 10
                      unblocked_count: 10
                Total Critical Threats Per Tenant:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      total_threats: 10
                Threat Summary:
                  value:
                    - blocked_count: 79760
                      malicious_count: 16654
                      sub_tenant_id: <sub-tenant-id>
                      total_threats: 99574
                      unblocked_count: 19814
                      unknown_count: 0
                      wildfire_verdict: 0
                Top Tenants with Unblocked Threats:
                  value:
                    - sub_tenant_id: <sub-tenant-id>
                      total: 99574
                      value: 19814
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/url/summary:
    post:
      tags:
        - Data Resource API
      summary: Get URL Count Summary
      description: Get URL count summary across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_UrlSummary'
            examples:
              Risky URL Count By Tenant:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: total_uri
                      alias: count
                      sort:
                        order: desc
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Blocked Risky URL Count By Tenant:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: blocked_uri_count
                      alias: count
                      sort:
                        order: desc
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Blocked Risky URL Count:
                value:
                  properties:
                    - property: blocked_uri_count
                      alias: count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Risky URL Count By Tenant:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      count: 10
                Blocked Risky URL Count By Tenant:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      count: 10
                Blocked Risky URL Count:
                  value:
                    count: 10
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/alerts:
    post:
      tags:
        - Data Resource API
      summary: Get Alerts Counts
      description: Get alerts counts across tenants resource
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Resource'
            examples:
              Alerts Count By Tenant:
                value:
                  properties:
                    - property: sub_tenant_id
                    - function: count
                      property: alert_id
                      alias: count

                  filter:
                    operator: AND
                    rules:
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
                      - property: updated_time
                        operator: last_n_days
                        values:
                          - 7
              Alerts Distribution By Severity:
                value:
                  properties:
                    - property: severity
                    - function: count
                      property: alert_id
                      alias: count
                      sort:
                        order: desc
                  filter:
                    operator: AND
                    rules:
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
                      - property: updated_time
                        operator: last_n_days
                        values:
                          - 7
              Alerts Trend:
                value:
                  properties:
                    - function: count
                      property: alert_id
                      alias: count
                      sort:
                        order: desc
                  filter:
                    operator: AND
                    rules:
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
                      - property: updated_time
                        operator: last_n_days
                        values:
                          - 7
                  histogram:
                    property: updated_time
                    range: day
                    enableEmptyInterval: false
                    value: "1"
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Alerts Count By Tenant:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      count: 10
                Alerts Distribution By Severity:
                  value:
                    - severity: <severity>
                      count: 3
                Alerts Trend:
                  value:
                    - updated_time: 1657238400000
                      count: 1
                    - updated_time: 1657411200000
                      count: 1
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/applications:
    post:
      tags:
        - Data Resource API
      summary: Get Applications Counts
      description: Get applications counts across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Resource'
            examples:
              Top Users Accessing Risky Apps:
                value:
                  properties:
                    - property: app_count
                      function: sum
                      alias: count
                      sort:
                        order: desc
                    - property: source_user_info_name
                      alias: user_name
                    - property: sub_tenant_id
                  filter:
                    operator: AND
                    rules:
                      - property: source_user_info_name
                        operator: not_equals
                        values:
                          - ""
                      - property: source_user_info_name
                        operator: is_not_null
                      - rule: app_risky
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                  count: 4
              Top Applications By Connection:
                value:
                  properties:
                    - property: session_id
                      function: count
                      alias: total_sessions
                      sort:
                        order: desc
                    - property: app_category
                    - property: sub_tenant_id
                  filter:
                    operator: AND
                    rules:
                      - property: app_category
                        operator: is_not_null
                      - property: app_category
                        operator: not_equals
                        values:
                          - ""
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                  count: 5
              Security Rules and Risky Apps:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: app_count
                      function: sum
                      alias: count
                      sort:
                        order: desc
                    - property: rule_matched
                      alias: rule_name
                  filter:
                    operator: AND
                    rules:
                      - rule: app_risky
                      - property: rule_matched
                        operator: not_equals
                        values:
                          - ""
                      - property: rule_matched
                        operator: is_not_null
                      - rule: unblocked
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                  count: 4

      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Top Users Accessing Risky Apps:
                  value:
                    - sub_tenant_id: <sub-tenant-id>
                      count: 12
                      user_name: <user-name>
                Top Applications By Connection:
                  value:
                    - sub_tenant_id: <sub-tenant-id>
                      total_sessions: 100
                      app_category: <app-category>
                Security Rules and Risky Apps:
                  value:
                    - sub_tenant_id: <sub-tenant-id>
                      count: 100
                      rule_name: <rule-name>
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/threats:
    post:
      tags:
        - Data Resource API
      summary: Get threats Counts
      description: Get threats counts across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Resource'
            examples:
              Threats Distribution by Threat Type:
                value:
                  properties:
                    - property: threat_sub_type
                    - property: threat_id
                      function: distinct_count
                      alias: unique_threat_count
                    - property: threat_count
                      function: sum
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                      - property: threat_sub_type
                        operator: is_not_null
                      - property: threat_sub_type
                        operator: not_equals
                        values:
                          - ""
              Threats Trend:
                value:
                  properties:
                    - property: threat_count
                      function: sum
                      alias: count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                  histogram:
                    property: event_time
                    range: day
                    enableEmptyInterval: false
                    value: "1"
              Security Rules and Unblocked Threats:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: threat_id
                      function: count
                      alias: threat_count
                      sort:
                        order: desc
                    - property: rule_matched
                      alias: rule_name
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                      - property: rule_matched
                        operator: is_not_null
                      - property: rule_matched
                        operator: not_equals
                        values:
                          - ""
                  count: 4
              Top Users with Critical Threats:
                value:
                  properties:
                    - property: threat_id
                      function: count
                      alias: unique_threat_count
                    - property: threat_count
                      function: sum
                      alias: total_threat_count
                      sort:
                        order: desc
                    - property: source_user
                    - property: source_user_info_name
                  filter:
                    operator: AND
                    rules:
                      - property: severity
                        operator: in
                        values:
                          - Critical
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                      - property: source_user
                        operator: is_not_null
                      - property: source_user
                        operator: not_equals
                        values:
                          - ""
                  count: 4
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Threats Distribution by Threat Type:
                  value:
                    - threat_sub_type: <threat_sub_type>
                      threat_count: 10
                      unique_threat_count: 5
                Threats Trend:
                  value:
                    - event_time: <event_time_ms>
                      count: 10
                Top Users with Critical Threats:
                  value:
                    - source_user: <source-user>
                      source_user_info_name: <source-user-info-name>
                      unique_threat_count: 3924
                      total_threat_count: 3999
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/resource:
    post:
      tags:
        - Data Resource API
      summary: Get Network Inventory Count
      description: Get network inventory across tenants
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Resource'
            examples:
              Network Inventory Count:
                value:
                  properties:
                    - property: node_type
                    - property: node_type
                      alias: node_count
                      function: count
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Network Inventory Count:
                  value:
                    - node_type: 48
                      node_count: 30
                    - node_type: 49
                      node_count: 10
                    - node_type: 50
                      node_count: 10
                    - node_type: 51
                      node_count: 4
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/urlLogs:
    post:
      tags:
        - Data Resource API
      summary: Get Top Tenants with Risky Urls
      description: Get Top Tenants with Risky Urls
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Resource'
            examples:
              Top Tenants with Risky URLs:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: uri_count
                      function: sum
                      alias: value
                      sort:
                        order: desc
                  filter:
                    operator: AND
                    rules:
                      - property: url_category_value
                        operator: in
                        values:
                          - high-risk
                          - malware
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
              Security Rules and Unblocked Risky Urls:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: uri_count
                      function: sum
                      sort:
                        order: desc
                    - property: rule_matched
                      alias: rule_name
                  filter:
                    operator: AND
                    rules:
                      - rule: url_high_risk
                      - rule: unblocked
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                      - property: rule_matched
                        operator: is_not_null
                      - property: rule_matched
                        operator: not_equals
                        values:
                          - ""
                  count: 4
              Top Users Accessing Unblocked Risky Urls:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: uri_count
                      function: sum
                      sort:
                        order: desc
                    - property: source_user_info_name
                      alias: user_name
                  filter:
                    operator: AND
                    rules:
                      - rule: url_high_risk
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - High
                          - Medium
                      - property: source_user_info_name
                        operator: is_not_null
                      - property: source_user_info_name
                        operator: not_equals
                        values:
                          - ""
                  count: 4
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Top Tenants with Risky URLs:
                  value:
                    - sub_tenant_id: <sub_tenant_id>
                      value: 340
                Security Rules and Unblocked Risky Urls:
                  value:
                    - rule_name: <rule-name>
                      sub_tenant_id: <sub-tenant-id>
                      uri_count: 300
                Top Users Accessing Unblocked Risky Urls:
                  value:
                    - sub_tenant_id: <sub-tenant-id>
                      uri_count: 596
                      user_name: <user-name>
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/applicationUsage:
    post:
      tags:
        - Data Resource API
      summary: Get Application Usage by Application type
      description: Get Application Usage by Application type
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Resource'
            examples:
              Risky Application Usage Trend:
                value:
                  properties:
                    - property: total_bytes
                      function: sum
                      alias: total_bytes_usage
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 7
                      - rule: app_risky
                  histogram:
                    property: event_time
                    range: day
                    enableEmptyInterval: false
                    value: "1"
              Top Apps by Data:
                value:
                  properties:
                    - property: app
                    - property: app
                      function: distinct_count
                      alias: unique_count
                    - property: total_bytes
                      function: sum
                      alias: total_bytes_usage
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                      - property: app
                        operator: is_not_null
                      - property: app
                        operator: not_equals
                        values:
                          - ""
              Top Application Categories by Data Usage:
                value:
                  properties:
                    - property: total_bytes
                      function: sum
                      alias: app_usage
                      sort:
                        order: desc
                    - property: app_sub_category
                  filter:
                    operator: AND
                    rules:
                      - property: app_sub_category
                        operator: is_not_null
                      - property: app_sub_category
                        operator: not_equals
                        values:
                          - ""
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 30
                  count: 5
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Risky Application Usage Trend:
                  value:
                    - event_time: <time in ms>
                      total_bytes_usage: 100
                Top Apps by Data:
                  value:
                    - app: <app-name>
                      total_bytes_usage: 10
                      unique_count: 1
                Top Application Categories by Data Usage:
                  value:
                    - app_sub_category: <app-sub-category>
                      app_usage: 100
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/serviceConnectivity:
    post:
      tags:
        - Data Resource API
      summary: Get RN and SC site status count
      description: Get RN and SC site status count
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Resource'
            examples:
              Site Status per Tenant:
                value:
                  properties:
                    - property: site_state_name
                    - property: node_type
                    - property: sub_tenant_id
                    - property: site_name
                      function: distinct_count
                      alias: count
                  filter:
                    rules:
                      - property: node_type
                        operator: in
                        values:
                          - 51
                          - 48
                      - property: site_state_name
                        operator: in
                        values:
                          - Up
                          - Down
              Site Status:
                value:
                  properties:
                    - property: node_type
                    - property: sub_tenant_id
                    - property: site_name
                      function: distinct_count
                      alias: count
                  filter:
                    rules:
                      - property: node_type
                        operator: in
                        values:
                          - 51
                          - 48
                      - property: site_state_name
                        operator: in
                        values:
                          - Up
                          - Down
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Site Status per Tenant:
                  value:
                    - site_state_name: Down
                      node_type: 48
                      sub_tenant_id: "9000000006"
                      count: 1
                    - site_state_name: Up
                      node_type: 51
                      sub_tenant_id: "9000000006"
                      count: 1
                Site Status:
                  value:
                    - site_state_name: Down
                      node_type: 48
                      count: 1
                    - site_state_name: Up
                      node_type: 51
                      count: 1
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/location/list:
    get:
      tags:
        - Data Resource API
      summary: Get Location List
      description: Get list of compute locations, latitude and longitude
      parameters:
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Location List:
                  value:
                    - cloudRegionName: "hong-kong"
                      locationName: "Hong Kong"
                      latitude: "22.3193"
                      longitude: "114.1694"
                    - cloudRegionName: "ap-northeast-1"
                      latitude: "36.2048"
                      locationName: "Japan Central"
                      longitude: "138.2529"
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/locationsTenants:
    post:
      tags:
        - Data Resource API
      summary: Get number of tenants at location
      description: Get number of tenants with assets at a specific compute location
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Resource'
            examples:
              Tenant Count at Location:
                value:
                  properties:
                    - property: sub_tenant_id
                      alias: unique_tenant_count
                      operator: distinct_count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_hours
                        values:
                          - 1
                      - property: edge_location_display_name
                        operator: in
                        values:
                          - "US Central"
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Tenant Count at Location:
                  value:
                    - unique_tenant_count: 100
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/locationsUsers:
    post:
      tags:
        - Data Resource API
      summary: Get number of users at location(s)
      description: Get number of users at or across compute locations
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          in: header
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Resource'
            examples:
              User Count across Locations:
                value:
                  properties:
                    - property: compute_location
                    - property: gpuser_name
                      alias: unique_user_count
                      operator: distinct_count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 90
                      - property: connection_state
                        operator: in
                        values:
                          - [ "CONNECTED", "CONNECT_CONTINUE" ]
                      - property: node_type
                        operator: equals
                        values:
                          - 49
              User Count at Location:
                value:
                  properties:
                    - property: gpuser_name
                      alias: unique_user_count
                      operator: distinct_count
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - 90
                      - property: connection_state
                        operator: in
                        values:
                          - [ "CONNECTED", "CONNECT_CONTINUE" ]
                      - property: node_type
                        operator: equals
                        values:
                          - 49
                      - property: edge_location_display_name
                        operator: in
                        values:
                          - "US Central"
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                User Count across Locations:
                  value:
                    - compute_location: "US Central"
                      unique_user_count: 10
                    - compute_location: "US West"
                      unique_user_count: 100
                    - compute_location: "US East"
                      unique_user_count: 1000
                User Count at Location:
                  value:
                    - unique_user_count: 100
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/incidents/count:
    post:
      tags:
        - Data Resource API
      summary: Get incident count by severity
      description: Get incident count by severity
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Incidents'
            examples:
              Incidents Count By Severity:
                value:
                  properties:
                    - property: total_count
                    - property: critical_count
                    - property: warning_count
                  filter:
                    rules:
                      - property: raised_time
                        operator: last_n_days
                        values:
                          - "1"
                      - property: status
                        operator: equals
                        values:
                          - Raised
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - Warning
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Incidents Count By Severity:
                  value:
                    - total_count: 20
                      critical_count: 10
                      warning_count: 10
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/incidents/impactedList:
    post:
      tags:
        - Data Resource API
      summary: Get list of impacted objects
      description: Get list of impacted objects
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Incidents'
            examples:
              List Of Impacted Objects:
                value:
                  filter:
                    operator: AND
                    rules:
                      - property: event_time
                        operator: last_n_days
                        values:
                          - "60"
                      - property: incident_id
                        operator: in
                        values:
                          - f2e7e5b7-c635-41e9-abfa-06697a382ebf
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                List Of Impacted Objects:
                  value:
                    - impacted_list: result
                      sites:
                        - SiteA
                      locations:
                        - LocationA
                      tunnels:
                        - TunnelA
                      bgp_peers:
                        - BGP1
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/incidents/list:
    post:
      tags:
        - Data Resource API
      summary: Get list of incidents
      description: Get list of incidents
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Incidents'
            examples:
              List Of Incidents:
                value:
                  properties:
                    - property: incident_id
                    - property: title
                    - property: sub_tenant_id
                    - property: severity
                    - property: category
                    - property: sub_category
                    - property: status
                    - property: created_time
                    - property: updated_time
                    - property: code
                    - property: clear_reason
                  filter:
                    operator: AND
                    rules:
                      - property: updated_time
                        operator: last_n_days
                        values:
                          - 1
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                List Of Incidents:
                  value:
                    - incident_id: "34898"
                      title: Tunnel1 is down
                      sub_tenant_id: 12345
                      severity: Warning
                      category: Prisma-Access
                      sub-category: sub-category
                      status: Raised
                      created_time: 123456789
                      updated_time: 9876543
                      code: AL_ABC
                      clear_reason: Auto
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/incidents/tenants:
    post:
      tags:
        - Data Resource API
      summary: Get top tenants by incidents count
      description: Get top tenants by incidents count(open critical + warning)
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Incidents'
            examples:
              Top Tenants By Incidents:
                value:
                  properties:
                    - property: sub_tenant_id
                    - property: total_count
                    - property: critical_count
                    - property: warning_count
                  filter:
                    rules:
                      - property: raised_time
                        operator: last_n_days
                        values:
                          - "1"
                      - property: status
                        operator: equals
                        values:
                          - Raised
                      - property: severity
                        operator: in
                        values:
                          - Critical
                          - Warning
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
                  count: 5
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Top Tenants By Incidents:
                  value:
                    - total_count: 20
                      critical_count: 10
                      warning_count: 10
                      sub_tenant_id: 123456
                    - total_count: 30
                      critical_count: 20
                      warning_count: 10
                      sub_tenant_id: 5678768
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/incidents/trends:
    post:
      tags:
        - Data Resource API
      summary: "Get incident trends(open critical, open warning, closed incidents)"
      description: Get incident count histogram
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_Incidents'
            examples:
              Open Critical Incidents Histogram:
                value:
                  histogram:
                    property: raised_time
                    enableEmptyInterval: true
                    range: minute
                    value: "5"
                  filter:
                    rules:
                      - property: raised_time
                        operator: last_n_hours
                        values:
                          - "1"
                      - property: status
                        operator: equals
                        values:
                          - Raised
                      - property: severity
                        operator: equals
                        values:
                          - Critical
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
              Open Warning Incidents Histogram:
                value:
                  histogram:
                    property: raised_time
                    enableEmptyInterval: true
                    range: minute
                    value: "5"
                  filter:
                    rules:
                      - property: raised_time
                        operator: last_n_hours
                        values:
                          - "1"
                      - property: status
                        operator: equals
                        values:
                          - Raised
                      - property: severity
                        operator: equals
                        values:
                          - Warning
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
              Cleared Incidents Histogram:
                value:
                  histogram:
                    property: cleared_time
                    enableEmptyInterval: true
                    range: minute
                    value: "5"
                  filter:
                    rules:
                      - property: cleared_time
                        operator: last_n_hours
                        values:
                          - "1"
                      - property: status
                        operator: equals
                        values:
                          - Cleared
                      - property: domain
                        operator: in
                        values:
                          - External
                          - external
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Open Critical Incidents Histogram:
                  value:
                    - histogram_time: 234567890
                      raised_time: 234567890
                      count: 10
                    - histogram_time: 73987654
                      raised_time: 73987654
                      count: 10
                Open Warning Incidents Histogram:
                  value:
                    - histogram_time: 234567890
                      raised_time: 234567890
                      count: 10
                    - histogram_time: 73987654
                      raised_time: 73987654
                      count: 10
                Cleared Incidents Histogram:
                  value:
                    - histogram_time: 234567890
                      cleared_time: 234567890
                      count: 10
                    - histogram_time: 73987654
                      cleared_time: 73987654
                      count: 10
        "400":
          description: Bad Request
        "500":
          description: Server Error

  /mt/monitor/v1/agg/custom/appMonitor/applications:
    get:
      tags:
        - App Monitor Resource API
      summary: Get Application for a given tenant with scores
      description: Get Application for a given tenant with scores
      parameters:
        - name: details
          in: query
          schema:
            type: string
        - name: end_time
          in: query
          schema:
            format: int64
            type: integer
        - name: start_time
          in: query
          schema:
            format: int64
            type: integer
        - name: time_period
          in: query
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Applications for selected tenant with application score and data usage:
                  value:
                    data:
                      - appName: Slack (Predefined)
                        dataUsage: 0
                        mu:
                          devices: 1
                          expScore: 0
                          fair: 0
                          good: 0
                          poor: 1
                        sessions: 0
                      - appName: Gmail
                        dataUsage: 0
                        mu:
                          devices: 1
                          expScore: 99.7
                          fair: 0
                          good: 1
                          poor: 0
                        sessions: 0
                      - appName: Salesforce (Predefined)
                        dataUsage: 0
                        mu:
                          devices: 1
                          expScore: 93.3
                          fair: 0
                          good: 1
                          poor: 0
                        sessions: 0
                    header:
                      createdAt: 2024-06-21T16:54:31Z
                      clientRequestId: f23fc52c-59cd-4615-bf28-3747b60fe7df
                      dataCount: 3
                      status:
                        subCode: 200
        "400":
          description: Bad Request
        "404":
          description: Data Not Found
        "500":
          description: Server Error
      security:
        - authKey: [ ]

  /mt/monitor/v1/agg/custom/appMonitor/nodeTrend:
    get:
      tags:
        - App Monitor Resource API
      summary: Get Application Monitor Node Trend
      description: Get Application Monitor Node Trend
      parameters:
        - name: app
          in: query
          schema:
            type: string
        - name: compare
          in: query
          schema:
            type: string
        - name: end_time
          in: query
          schema:
            format: int64
            type: integer
        - name: nodeType
          in: query
          schema:
            type: string
        - name: start_time
          in: query
          schema:
            format: int64
            type: integer
        - name: time_period
          in: query
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Node Trend with Application Score:
                  value:
                    data:
                      - event_time: 1718382600
                        mu_exp_score: 65.5
                        rn_exp_score: 0
                        app_score: 0
                      - event_time: 1718384400
                        mu_exp_score: 63.5
                        rn_exp_score: 0
                        app_score: 0
                      - event_time: 1718386200
                        mu_exp_score: 63.5
                        rn_exp_score: 0
                        app_score: 0
                      - event_time: 1718388000
                        mu_exp_score: 64.8
                        rn_exp_score: 0
                        app_score: 0
                    header:
                      createdAt: 2024-06-21T16:54:29Z
                      clientRequestId: f23fc52c-59cd-4615-bf28-3747b60fe7df
                      dataCount: 336
                      status:
                        subCode: 200
        "400":
          description: Bad Request
        "404":
          description: Data Not Found
        "500":
          description: Server Error
      security:
        - authKey: [ ]

  /mt/monitor/v1/agg/custom/appMonitor/tenants:
    get:
      tags:
        - App Monitor Resource API
      summary: Get Child Tenant
      description: 'Get Child Tenant '
      parameters:
        - name: end_time
          in: query
          schema:
            format: int64
            type: integer
        - name: start_time
          in: query
          schema:
            format: int64
            type: integer
        - name: time_period
          in: query
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Tenants with Application Score:
                  value:
                    header:
                      createdAt: 2022-05-24T18:45:23Z
                      clientRequestId: bQjz75Kp8L84_XSpnpbdOqJ7CanAio5rpdBJyfM0
                      dataCount: 4
                      status:
                        subCode: 200
                    data:
                      - rn_exp_score: 20
                        mu_exp_score: 10
                        tsg_id: "1742631264"
                        unique_app_count: 20
                        total_app_usage: 1234
                        total_sessions: 200453
                      - rn_exp_score: 2
                        mu_exp_score: 200
                        tsg_id: "1942831464"
                        unique_app_count: 90
                        total_app_usage: 76857
                        total_sessions: 33
                      - rn_exp_score: 20
                        mu_exp_score: 10
                        tsg_id: "20744631264"
                        unique_app_count: 40
                        total_app_usage: 9987
                        total_sessions: 7587
        "400":
          description: Bad Request
        "404":
          description: Data Not Found
        "500":
          description: Server Error
      security:
        - authKey: [ ]

  /mt/monitor/v1/agg/custom/license/quota:
    get:
      tags:
        - License Resource API
      summary: Get License Quota for Tenant
      description: Get License Quota for Tenant
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LicenseQuota'
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/custom/license/setup/status:
    get:
      tags:
        - License Resource API
      summary: Get Service Setup Status
      description: Get Licensed Service Setup Status
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceSetupStatus'
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/custom/license/utilization:
    get:
      tags:
        - License Resource API
      summary: Get License Utilization for Tenant
      description: Get License Utilization for Tenant. Either provide start and end time or time_period
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: end_time
          description: This is the time upto which user wants to see the data
          example: 98765432
          in: query
          schema:
            format: int64
            type: integer
        - name: start_time
          description: This is the time from which user wants to see the data
          example: 123456789
          in: query
          schema:
            format: int64
            type: integer
        - name: product_type
          description: The value can be MU(Mobile Users), RN(Remote Networks)
          example: MU,RN
          in: query
          schema:
            type: string
        - name: threshold
          description: This value is the license utilization threshold. It can be any integer number, default is -1
          example: -1
          in: query
          schema:
            format: double
            type: number
        - name: time_period
          description: This is the time range for which user wants to see the data.The value can be last 15m, 1h, 3h, 24h, 7d, 30d
          example: 1h
          in: query
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LicenseUtilization'
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/custom/tenant/hierarchy:
    get:
      tags:
        - Tenant Resource API
      summary: Get Tenant Hierarchy
      description: 'Get tenant hierarchy '
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TenantHierarchy'
        "400":
          description: Bad Request
        "500":
          description: Server Error
  /mt/monitor/v1/agg/upgrades/list:
    post:
      tags:
        - Insights Resource Api
      summary: Get Upgrade List
      description: Get Upgrade List
      parameters:
        - name: agg_by
          description: The value should be 'tenant'(if you want aggregated results across all child tenants) or empty.
          in: query
          example: tenant
          schema:
            type: string
        - name: X-PANW-Region
          description: This will be one of the 9 supported regions(americas, europe, au,de, jp, ca, sg, uk, in)
          example: americas
          in: header
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestBody_UpgradesList'
            examples:
              Upgrade List:
                value:
                  properties:
                    - property: tenant_id
                    - property: sub_tenant_id
                    - property: current_version
                    - property: candidate_release_list
                    - property: customer_onboarded_locations
                    - property: upgrade_ts
                    - property: time_window
                    - property: compute_timezone
                    - property: upgrade_ts
                    - property: upgrade_type
                    - property: upgrade_version
                    - property: status
                  filter:
                    operator: AND
                    rules:
                      - property: start_date
                        operator: equals
                        values:
                          - ["2023-05-01T01:00:00.000Z"]
                      - property: end_date
                        operator: equals
                        values:
                          - ["2023-05-01T01:00:00.000Z"]
      responses:
        "200":
          description: Success
          content:
            application/json:
              examples:
                Upgrade List:
                  value:
                    - tenant_id: <tenant_id>
                    - sub_tenant_id: <sub_tenant_id>
                    - current_version: <amiversion>
                    - candidate_release_list: <candidate_release_list>
                    - customer_onboarded_locations: <customer_onboarded_locations>
                    - upgrade_ts: <upgrade_ts>
                    - time_window: <time_window>
                    - compute_timezone: <compute_timezone>
                    - upgrade_ts: <upgrade_ts>
                    - upgrade_type: <upgrade_type>
                    - upgrade_version: <upgrade_version>
                    - status: <status>
        "400":
          description: Bad Request
        "500":
          description: Server Error

components:
  schemas:
    AlertFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            type: object
          anyOf:
            - $ref: '#/components/schemas/AlertRule'
            - $ref: '#/components/schemas/TimeFilter'
    AlertProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, total_count, mu_count, rn_count, sc_count"
    AlertRule:
      type: object
      properties:
        property:
          description: Filter property field that is one of the example values
          type: string
          example: domain
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          type: string
          example: in
        values:
          description: Filter property value
          type: array
          items:
            type: string
          example: "External, external if property is domain"
    AppSrcFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            type: object
          anyOf:
            - $ref: '#/components/schemas/AppSrcRule'
            - $ref: '#/components/schemas/TimeFilter'
    AppSrcProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, total_app_count, total_app_remote_network, total_app_mobile_users,total_app_proxy_nodes"
    AppSrcRule:
      type: object
      properties:
        rule:
          description: Rule name that is set to one of the example values
          type: string
          example: app_risky
    AppSummaryFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            type: object
          anyOf:
            - $ref: '#/components/schemas/AppSummaryRule'
            - $ref: '#/components/schemas/TimeFilter'
    AppSummaryProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, total_app_count, total_app_remote_network, total_app_mobile_users,total_app_proxy_nodes"
    AppSummaryRule:
      type: object
      properties:
        rule:
          description: Rule name that is set to one of the example values
          type: string
          example: app_risky
    ApplicationFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            $ref: '#/components/schemas/FilterRule'
          anyOf:
            - $ref: '#/components/schemas/ApplicationRule'
            - $ref: '#/components/schemas/TimeFilter'
    ApplicationProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, app, unique_app_count, app_count"
        function:
          description: Operations that need to be run on the property field. Operations
            can be run only on number properties.
          type: string
          example: "count, sum, avg"
        sort:
          $ref: '#/components/schemas/Sort'
    ApplicationRule:
      type: object
      properties:
        rule:
          description: Rule name that is set to one of the example values
          type: string
          example: "app_risky, blocked"
    CDLStatusFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            type: object
          anyOf:
            - $ref: '#/components/schemas/CDLStatusRule'
    CDLStatusProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, state, location_count"
    CDLStatusRule:
      type: object
      properties:
        property:
          description: Filter property field that is one of the example values
          type: string
          example: status
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          type: string
          example: in
        values:
          description: Filter property value
          type: array
          items:
            type: string
          example: "Up, Down if property is status"
    FilterRule:
      type: object
    GatewayStatusProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, status, gateway_count"
    IncidentFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            type: object
          anyOf:
            - $ref: '#/components/schemas/IncidentRule'
            - $ref: '#/components/schemas/TimeFilter'
    IncidentProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, total_count, warning_count, critical_count, created_time, updated_time, category, status, raised_time, cleared_time"
    IncidentRule:
      type: object
      properties:
        property:
          description: Filter property field that is one of the example values
          type: string
          example: status
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          type: string
          example: in
        values:
          description: Filter property value
          type: array
          items:
            type: string
          example: "Raised, Cleared"
    OutlierRule:
      type: object
      properties:
        property:
          description: Filter property field that is one of the example values
          type: string
          example: node_type
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          type: string
          example: in
        values:
          description: Filter property value
          type: array
          items:
            type: string
          example: "48, 49 if property is node_type"
    OutliersFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            type: object
          anyOf:
            - $ref: '#/components/schemas/OutlierRule'
            - $ref: '#/components/schemas/TimeFilter'
    OutliersProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "site_name, bandwidth_consumed, unit"
    RequestBody_Alert:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/AlertProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/AlertFilter'
            - description: filter json object
    RequestBody_AppSrc:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/AppSrcProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/AppSrcFilter'
            - description: filter json object
    RequestBody_AppSummary:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/AppSummaryProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/AppSummaryFilter'
            - description: filter json object
    RequestBody_Application:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/ApplicationProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/ApplicationFilter'
            - description: filter json object
    ServiceConnectivityCount:
      required:
        - sub_tenant_id
        - status
        - mu_count
        - cdl_count
        - sc_count
        - rn_count
      type: object
      properties:
        sub_tenant_id:
          description: CDL Tenant Id
          type: string
        status:
          description: Status of the connection
          type: string
        mu_count:
          format: int32
          description: Number of Mobile Users for the tenant with specific status
          type: integer
        cdl_count:
          format: int32
          description: Number of Cortex Datalake Connections for the tenant with specific status
          type: integer
        sc_count:
          format: int32
          description: Number of Service Connections for the tenant with specific status
          type: integer
        rn_count:
          format: int32
          description: Number of Remote Networks for the tenant with specific status
          type: integer
    RequestBody_CDLStatus:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/CDLStatusProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/CDLStatusFilter'
            - description: filter json object
    RequestBody_GatewayStatus:
      required:
        - properties
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/GatewayStatusProperty'
    RequestBody_Incidents:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/IncidentProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/IncidentFilter'
            - description: filter json object
    RequestBody_Outliers:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/OutliersProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/OutliersFilter'
            - description: filter json object
    RequestBody_Resource:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/ResourceProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/ResourceFilter'
            - description: filter json object
    RequestBody_Threat:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/ThreatProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/ThreatFilter'
            - description: filter json object
    RequestBody_ThreatSrc:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/ThreatSrcProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/ThreatSrcFilter'
            - description: filter json object
    RequestBody_ThreatSummary:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/ThreatSummaryProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/ThreatSummaryFilter'
            - description: filter json object
    RequestBody_UniqueUsers:
      required:
        - properties
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/UniqueUserProperty'
    RequestBody_UrlSummary:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/UrlSummaryProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/UrlSummaryFilter'
            - description: filter json object
    ResourceFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            type: object
          anyOf:
            - $ref: '#/components/schemas/TimeFilter'
            - $ref: '#/components/schemas/UrlLogsRule'
    ResourceProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "severity,alert_id,node_type,node_count"
    Sort:
      type: object
      properties:
        order:
          description: Sort Order for the property
          type: string
          example: "desc, asc"
    ThreatFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            $ref: '#/components/schemas/FilterRule'
          anyOf:
            - $ref: '#/components/schemas/ThreatRule'
            - $ref: '#/components/schemas/TimeFilter'
    ThreatProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, total_threats, blocked_count, unblocked_count, malicious_count, unknown_count"
        sort:
          $ref: '#/components/schemas/Sort'
    ThreatRule:
      type: object
      properties:
        property:
          description: Filter property field that is one of the example values
          type: string
          example: severity
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          type: string
          example: in
        values:
          description: Filter property value
          type: array
          items:
            type: string
          example: "Critical, High, Medium \n(used with severity in)"
    ThreatSrcFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            $ref: '#/components/schemas/FilterRule'
          anyOf:
            - $ref: '#/components/schemas/ThreatSrcRule'
            - $ref: '#/components/schemas/TimeFilter'
    ThreatSrcProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, total_app_count, total_app_remote_network, total_app_mobile_users,total_app_proxy_nodes"
    ThreatSrcRule:
      type: object
      properties:
        property:
          description: Filter property field that is one of the example values
          type: string
          example: threat_severity
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          type: string
          example: in
        values:
          description: Filter property values
          type: array
          items:
            type: string
          example: "Critical, High, Medium \n(used with severity in)"
    ThreatSummaryFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            $ref: '#/components/schemas/FilterRule'
          anyOf:
            - $ref: '#/components/schemas/ThreatSummaryRule'
            - $ref: '#/components/schemas/TimeFilter'
    ThreatSummaryProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, total_threats, blocked_count, unblocked_count,malicious_count"
    ThreatSummaryRule:
      type: object
      properties:
        property:
          description: Filter property field that is one of the example values
          type: string
          example: severity
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          type: string
          example: in
        values:
          description: Filter property values
          type: array
          items:
            type: string
          example: "Critical, High, Medium \n(used with severity in)"
    TimeFilter:
      type: object
      properties:
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          type: string
          example: "gt, lt, last_n_minutes, last_n_hours, last_n_days"
        property:
          description: Filter property field that is one of the example values
          type: string
          example: "event_time, update_time, updated_time"
        values:
          description: Filter property value
          type: array
          items:
            type: string
          example: "minute, hour or day counts if property is event_time"
    UniqueUserProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "user_count"
    UrlLogsRule:
      type: object
      properties:
        property:
          description: Filter property field that is one of the example values
          type: string
          example: url_category_value
        operator:
          description: Filter operator that is one of the example values and is run
            on the property field
          type: string
          example: in
        values:
          description: Filter property values
          type: array
          items:
            type: string
          example: "high-risk, malware \n(used with url_category_value in)"
    UrlSummaryFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            $ref: '#/components/schemas/FilterRule'
          anyOf:
            - $ref: '#/components/schemas/UrlSummaryRule'
            - $ref: '#/components/schemas/TimeFilter'
    UrlSummaryProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, uri_count"
        function:
          description: Operations that need to be run on the property field. Operations
            can be run only on number properties.
          type: string
          example: sum
        sort:
          $ref: '#/components/schemas/Sort'
    UrlSummaryRule:
      type: object
      properties:
        rule:
          description: Rule name that is set to one of the example values
          type: string
          example: "url_high_risk, blocked"


    LicenseDetails:
      required:
        - license_units
        - expiry_ts
        - issue_ts
        - sku
        - license_allocated_unit
      type: object
      properties:
        license_units:
          format: int32
          description: Number of license units associated with the license
          type: integer
        expiry_ts:
          format: int64
          description: License expiry timestamp in UTC
          type: integer
        issue_ts:
          format: int64
          description: License issuance timestamp in UTC
          type: integer
        sku:
          description: License Edition SKU
          type: string
        license_allocated_unit:
          type: string
          description: Units which is Mbps or no units at all (for MU)

    LicenseQuota:
      required:
        - tsg_id
        - sub_tenant_id
        - licenseDetails
        - support
      type: object
      properties:
        tsg_id:
          description: TSG Id
          type: string
        sub_tenant_id:
          description: CDL Tenant Id
          type: string
        licenseDetails:
          description: "Map of <Resource Name, License Details>, where Resource Name can be one of MU, RN, CDL"
          type: object
          additionalProperties:
            $ref: '#/components/schemas/LicenseDetails'
        support:
          allOf:
            - $ref: '#/components/schemas/Support'
            - description: |
                Tenant Ids and Region info used for opening a support ticket

    LicenseUtilization:
      required:
        - sub_tenant_id
        - utilization_percentage
        - product_type
        - license_units_used
        - license_used_unit
        - license_units
        - license_unit
      type: object
      properties:
        sub_tenant_id:
          description: CDL Tenant Id
          type: string
        utilization_percentage:
          format: double
          description: Utilization Percentage
          type: number
        product_type:
          description: "Product Resource Type which is one of the following: RN, MU"
          type: string
        license_units_used:
          format: double
          description: Number of license units used by the tenant
          type: number
        license_used_unit:
          description: Units which can be Kbps or Mbps or no units at all (for MU)
          type: string
        license_units:
          format: double
          description: Number of license units allocated to the tenant
          type: number
        license_unit:
          description: Units which can be Kbps or Mbps or no units at all (for MU)
          type: string

    RequestBody_UpgradesList:
      required:
        - properties
        - filter
      type: object
      properties:
        properties:
          description: List of property json objects
          type: array
          items:
            $ref: '#/components/schemas/UpgradeListProperty'
        filter:
          allOf:
            - $ref: '#/components/schemas/UpgradeListFilter'
            - description: filter json object

    ServiceSetupStatus:
      required:
        - tsg_id
        - cdl_tenant_id
        - operational_status
        - service_setup_status
      type: object
      properties:
        tsg_id:
          description: TSG Id
          type: string
        cdl_tenant_id:
          description: CDL Tenant Id
          type: string
        operational_status:
          description: "Operational status which can be any one of the following values: No License, Warning, Error, Complete, Activating"
          type: string
        service_setup_status:
          description: "Licensed service setup status which can be any one of the following values: No License, License Allocated, License Activated, Components Configured"
          type: string

    Support:
      required:
        - cdl_tenant_id
        - pa_tenant_id
        - fawkes_tenant_id
        - panorama_tenant_id
        - cdl_tenant_region
        - pa_tenant_region
        - fawkes_tenant_region
        - panorma_tenant_region
      type: object
      properties:
        cdl_tenant_id:
          description: CDL Tenant Id
          type: string
        pa_tenant_id:
          description: PA Tenant Id
          type: string
        fawkes_tenant_id:
          description: Fawkes Tenant Id
          type: string
        panorama_tenant_id:
          description: Panorama Tenant Id
          type: string
        cdl_tenant_region:
          description: CDL Tenant Region
          type: string
        pa_tenant_region:
          description: PA Tenant Region
          type: string
        fawkes_tenant_region:
          description: Fawkes Tenant Region
          type: string
        panorma_tenant_region:
          description: Panorama Tenant Region
          type: string

    TenantHierarchy:
      required:
        - cdlTenantId
        - display_name
        - id
        - license_activated
        - tenantLicenseType
        - vertical
      type: object
      properties:
        cdlTenantId:
          description: CDL Tenant Id
          type: string
        children:
          description: List of Child Tenants which are of type Tenant Hierarchy
          type: array
          items:
            $ref: '#/components/schemas/TenantHierarchy'
        display_name:
          description: Tenant Display Name
          type: string
        id:
          description: TSG Id
          type: string
        license_activated:
          description: License Activation Flag
          type: boolean
        region:
          description: "Set of CDL regions which can be any one of  us01, eu01, au01, de01, jp01, ca01, sg01, uk01"
          uniqueItems: true
          type: array
          items:
            type: string
        tenantLicenseType:
          description: "Tenant License Type which can be any one of PA_ONLY, SDWAN_ONLY, SASE, PA_SDWAN"
          type: string
        vertical:
          description: Customer Vertical
          type: string
    UpgradeListFilter:
      required:
        - operator
      type: object
      properties:
        operator:
          description: Always set to AND
          type: string
        rules:
          type: array
          items:
            $ref: '#/components/schemas/TimeFilter'
    UpgradeListProperty:
      type: object
      properties:
        alias:
          type: string
        property:
          description: Property field name. Property fields will be returned in the
            API response.
          type: string
          example: "sub_tenant_id, amiversion, current_software_version, last_upgrade_date,next_upgrade_scheduled_str, status, error, next_upgrade_scheduled"